(function(a,c){function d(){d.__superclass__.call(this)}var b;d.BLEND_NONE=0;d.BLEND_DISPLACEMENT=1;d.BLEND_COLOR_DISPLACEMENT=2;d.BLEND_ADDITIVE=4;d.PaintModule=function(Q,e,L,I,s){if(b==0){this.PaintModule(Q,e,L,I,s);return}if(e<0){return}var F=GetModuleWidth(e);var E=GetModuleHeight(e);if(F<=0||E<=0){return}var u=Q.getClipX();var t=Q.getClipY();var w=Q.getClipWidth();var B=Q.getClipHeight();if(L+F<u||I+E<t||L>=u+w||I>=t+B){return}if(L+F<u||I+E<t||L>=u+w||I>=t+B){return}var r=L;var q=I;var H=F;var G=E;if(L<u){H-=u-L;r=u}if(L+F>=u+w){H=(u+w)-L}if(I<t){G-=t-I;q=t}if(I+E>=t+B){G=(t+B)-I}var l=GetCurrentPalette();var j=F*E;var v=[];var K=0;if(_module_image_intAAA!=null&&_module_image_intAAA[l]!=null&&_module_image_intAAA[l][e]!=null){v=_module_image_intAAA[l][e];K=v.length}else{v=DecodeImage(e);K=F*E}var J=LowAPI.Gen_Array([K],0);if((s&FLAG_FLIP_Y)!=0){if(v!=null){var x=LowAPI.Gen_Array([F*E],0);for(var P=0;P<E;P++){System.arraycopy(v,P*F,x,(E-P-1)*F,F)}v=x}}var M=(q-I)*F+(r-L);if(GLLibConfig.useSoftwareDoubleBuffer){GloftCAOF._gameInstance.GetSoftwareDoubleBuffer().getRGB(J,M,F,r,q,H,G)}if(b==BLEND_DISPLACEMENT){var D=0;for(var P=F*E;P>0;P--){var k=0;if(v!=null){k=(v[D]&255)>>5}if(k>0){var m=D+k*F;J[D]=J[m]}D++}}else{if(b==BLEND_COLOR_DISPLACEMENT){var D=0;for(var P=j;P>0;P--){var h=0;if(v!=null){h=(v[D])}var z=h&255;var k=z>>5;if(k>0){var m=D+(k>>2)*F;var f=J[m];var n=(f)&16711680;var N=(f)&65280;var y=(f)&255;var C=n+(n*k>>3);C=(((C<<7)>>31)|C)&16711680;var p=N+(N*k>>3);p=(((p<<15)>>31)|p)&65280;var R=y+(y*k>>3);R=(((R<<23)>>31)|R)&255;var A=C|p|R;J[D]=A}D++}}else{if(b==BLEND_ADDITIVE){var D=0;for(var P=j;P>0;P--){var h=0;if(v!=null){h=(v[D])}var o=(h)&16711680;var O=(h)&65280;var z=(h)&255;var f=J[D];var n=(f)&16711680;var N=(f)&65280;var y=(f)&255;var C=o+n;if(C>16711680){C=16711680}else{C&=16711680}var p=O+N;if(p>65280){p=65280}else{p&=65280}var R=z+y;if(R>255){R=255}var A=C|p|R;J[D]=A;D++}}}}if(GLLibConfig.useDrawPartialRGB){CGame.DrawRGB(J,0,F,L,I,F,E,true)}else{CGame.DrawRGB(J,M,F,r,q,H,G,true)}};LowAPI.extendClass(d,ASprite);LowAPI.extendObject(a,{CBlendSprite:d,},true)})(window);