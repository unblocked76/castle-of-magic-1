<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=0"/>
        <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
        <meta name="google" content="notranslate"/>
        <link type="image/x-icon" href="js/300x300.png" rel="shortcut icon" />
		<link rel="apple-touch-icon" sizes="300x300" href="js/300x300.png" />
		<link rel="shortcut icon" sizes="300x300" href="js/300x300.png" />
        <title>Castle of Magic</title>
        <link rel="stylesheet" type="text/css" href="js/core/gllib.main.css"/>
        <style>
			#overlay{position:fixed;width:100%;height:100%;top:0;left;0;background-color:rgba(0,0,0,1); display:none;}
        </style>
			<script type='text/javascript'>
			window.adsState = 0;
			window["GD_OPTIONS"] = {
						"gameId": "e1d495f7d54d49729ed9f2cb1a35b2ce",
						"onEvent": function(event) {
								window.dispatchEvent(new CustomEvent(event.name, {}));
								switch (event.name) {
										case "SDK_GAME_START":
												window.focus();
												window.adsState = 2;
												// advertisement done, resume game logic and unmute audio
												break;
										case "SDK_GAME_PAUSE":
												// pause game logic / mute audio
												break;
										case "SDK_GDPR_TRACKING":
												// this event is triggered when your user doesn't want to be tracked
												break;
										case "SDK_GDPR_TARGETING":
												// this event is triggered when your user doesn't want personalised targeting of ads and such
												break;
										case "SDK_REWARDED_WATCH_COMPLETE":
												// this event is triggered when your user completely watched rewarded ad
												break;
								}
						},
				};
				(function(d, s, id) {
						var js, fjs = d.getElementsByTagName(s)[0];
						if (d.getElementById(id)) return;
						js = d.createElement(s);
						js.id = id;
						js.src = 'patch/js/gd-main.js';
						fjs.parentNode.insertBefore(js, fjs);
				}(document, 'script', 'gamedistribution-jssdk'));
			</script>
    </head>
    <body> 
		<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K74X66" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
		<!-- <script src="//play.ludigames.com/js/cookieconsent.js" charset="utf-8"></script> -->
		<!-- common functions -->
		<script type='text/javascript'>
			document.addEventListener('keydown', function(event) {
					event.preventDefault();
				});
			window.playAds = function(){};
			function insertScript(d, s, id, url) {
				var js, fjs = d.getElementsByTagName(s)[0];
				if (d.getElementById(id)) {
					return;
				}
				js = d.createElement(s);
				js.id = id;
				js.src = url;
				fjs.parentNode.insertBefore(js, fjs);
			}

			function loadOrderScript(url1, url2, url3) {
				var script1 = document.createElement('script');
				script1.setAttribute('src', url1);
				script1.onload = function() {
					if (typeof(url2) != 'undefined') {
						var script2 = document.createElement('script');
						script2.setAttribute('src', url2);
						script2.onload = function() {						
							if (typeof(url3) != 'undefined') {
								var script3 = document.createElement('script');
								script3.setAttribute('src', url3);
								document.body.appendChild(script3);
							}
						}
						document.body.appendChild(script2);
					}
				}
				document.body.appendChild(script1);
			}
		</script>
		<!-- end common -->
		
		<input type="hidden" id="page_is_dirty" value="no">
		<script type="text/javascript">
			onload = function () {
				var e = document.getElementById("page_is_dirty");
				if (e.value == "no") e.value = "yes";
				else { e.value = "no"; location.reload(); }
			}
			window.show_freeFrame = function(){}
			productKey = "blockBreaker3Unlimited";
			
			var gtmID = "";
			
			gtmID = 'GTM-K74X66';
			var enableADS = !true;
			dataLayer = [];
			var productTitle = "Castle Of Magic"; // for tracking game name
			dataLayer.push({
				'event': 'pageLoad',
				'publisher' :'GAMELOFT',
					'productKey': '' + productKey
			});
			

			(function(w, d, s, l, i) {
				w[l] = w[l] || [];
				w[l].push({
					'gtm.start': new Date().getTime(),
					event: 'gtm.js'
				});
				var f = d.getElementsByTagName(s)[0],
					j = d.createElement(s),
					dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src =
					'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore(j, f);
			})(window, document, 'script', 'dataLayer', gtmID);
			
			function setCookie(cname,cvalue) {
				var d = new Date();
				d.setTime(d.getTime() + (1*365*24*60*60*1000));
				var expires = "expires=" + d.toGMTString();
				document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
			}
			function getCookie(cname) {
				var name = cname + "=";
				var decodedCookie = decodeURIComponent(document.cookie);
				var ca = decodedCookie.split(';');
				for(var i = 0; i < ca.length; i++) {
				  var c = ca[i];
				  while (c.charAt(0) == ' ') {
					c = c.substring(1);
				  }
				  if (c.indexOf(name) == 0) {
					return c.substring(name.length, c.length);
				  }
				}
				return "";
			}
			<!-- function getReferrer(){ // also save to cookie  -->
				<!-- window.referrer = getCookie("root_referrer"); -->
				<!-- if(window.referrer != ""){			   -->
				  <!-- console.log("referal from cookie: "+window.referrer); -->
				<!-- }else{ -->
				  <!-- var ref = document.referrer; -->
				  <!-- if(ref!=""){ -->
					<!-- setCookie("root_referrer",ref); -->
					<!-- window.referrer = ref; -->
					<!-- console.log("save referal from document: "+window.referrer); -->
				  <!-- }else{ -->
					<!-- var ser_url= window.location.search; -->
					<!-- window.referrer = "https://play.ludigames.com" + ser_url; -->
					<!-- console.log("default referal: "+window.referrer); -->
				  <!-- }			   -->
				<!-- } -->
				<!-- return window.referrer; -->
			<!-- } -->
			<!-- getReferrer(); -->
		</script>
        <div id="gameloft-root-div"></div>
		<img src="js/core/ads/loading.gif" id="loading_gif" style="width:80px;height:80px;position: fixed;top: 50%;left: 50%;margin-top: -40px;margin-left: -40px;display: none">
		<div class="overlay" id="overlay"></div>
		<img src="js/ht_ui_rotate_screen.png" id="modal" style="width:80px;height:80px;position: fixed;top: 50%;left: 50%;margin-top: -40px;margin-left: -40px;display: none">
        <script type="text/javascript" src="js/core/gllib.main.js"></script>
        
        <script type="text/javascript" src="js/sampleapp.main.js"></script>
        <script type="text/javascript">
			var overlayID = document.getElementById("overlay");
			var modalID = document.getElementById("modal");
			var loading_gif = document.getElementById("loading_gif");
			window.mobileAndTabletcheck = function()
			{
				var check = false;
				(function(a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))) check = true;})(navigator.userAgent||navigator.vendor||window.opera);
				return check;
			}
			var isMobile = mobileAndTabletcheck();
			var startAtLandscape = false;
			if(window.innerWidth > window.innerHeight)
			{
				if(isMobile)
				{
					overlayID.style.display = "inline";
					modalID.style.display = "inline";
					startAtLandscape = true;
				}
				
			}
			window.addEventListener("resize",
			function() {
					<!-- if(ChangeFromGameToIGM) -->
						<!-- ChangeFromGameToIGM(); -->
					if(jQuery(window).width() > jQuery(window).height())
					{
						if(!isMobile)
						{
						
							overlayID.style.display = "none";
							modalID.style.display = "none";
						}
						else
						{
							overlayID.style.display = "inline";
							modalID.style.display = "inline";
						}
					}
					else
					{
						if(startAtLandscape)
						{
							startAtLandscape = false;
							location.reload(false);
						}
						overlayID.style.display = "none";
						modalID.style.display = "none";
					}
				});
		</script>
    </body>
</html>