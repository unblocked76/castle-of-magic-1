(function(y,d){function q(g,A){q.__superclass__.call(this);this.m_frameCoheranceTimer=0;this.constructor(g,A)}LowAPI.extendClass(q,Canvas);q.statics=window;var o=null;window.s_lastPaintGraphics=null;window.s_game_isPaused=false;var l=0;var i=0;var z=GLLibConfig.screenWidth;var h=GLLibConfig.screenHeight;var w=null;var e=false;var k=null;var b=LowAPI.Float2Int(1000/GLLibConfig.FPSLimiter);window.s_game_frameDT=0;var a=0;window.s_game_totalExecutionTime=0;var s=0;var j=null;q.prototype.handleMessage=function(){var A=this;var g=GameState.getCurrentState();if(g!=null){g.handleMessage.apply(g,arguments)}else{Warn("The message was sent to an unknown state.")}};q.prototype.Game_update=function(){throw new Error("GLLib.prototype.Game_update() # abstract function called: must be overriden!")};q.prototype.Game_Loop=function(){if(!s_game_isPaused){this.repaint();GLLibPlayer.Snd_Update()}};q.prototype.constructor=function(g,A){Dbg("GLLib.constructor");j=this;l=-1;k=g;w=A;this.SetupDisplay();this.SetupDefaultKey();a=System.currentTimeMillis();this.m_frameCoheranceTimer=a};q.prototype.Init=function(){if(l>=0){return}z=GLLibConfig.screenWidth;h=GLLibConfig.screenHeight;if(GLLibConfig.useQwertyKeyboard){s_nbKey=GLKey.k_nbQwertyKey}if(GLLibConfig.useKeyAccumulation){s_keyState=LowAPI.Gen_Array([s_nbKey],0);s_keyStateRT=LowAPI.Gen_Array([s_nbKey],0)}if(GLLibConfig.sprite_useSingleImageForAllModules||GLLibConfig.pfx_enableFrameCaching||GLLibConfig.pfx_enableModuleCaching){r()}Math_RandSetSeed(System.currentTimeMillis());l=0;this.SetupDisplay();gllib_runtime.addAnimationFrame(this.run,this)};q.prototype.UnInit=function(){if(GLLibConfig.useKeyAccumulation){s_keyState=null;s_keyStateRT=null}};q.prototype.Pause_GLLib=function(){if(!s_game_isPaused){s_game_isPaused=true;Dbg("GLLib.Pausing");GLLibPlayer.Snd_PauseNotify()}};q.prototype.Resume_GLLib=function(){if(s_game_isPaused){Dbg("GLLib.Resuming");var g=System.currentTimeMillis();i=g;a=g;this.m_frameCoheranceTimer=g;s_game_isPaused=false;this.SetupDisplay();if((GLLibConfig.useRepaintAtResume)&&(!e)){this.repaint()}ResetKey()}};q.prototype.hideNotify=function(){this.Pause_GLLib()};q.prototype.showNotify=function(){this.Resume_GLLib()};q.prototype.SetupDisplay=function(){if(!GLLibConfig.MIDP2forceNonFullScreen){this.setFullScreenMode(true)}if(w!=null){if(w.getCurrent()!=this){w.setCurrent(this)}}};q.prototype.run=function(){if(this.catchThrowError){if(this.catchThrowError.stack){Err("ERROR #"+this.catchThrowError.stack)}else{Err("ERROR # "+this.catchThrowError)}throw this.catchThrowError}try{var g=System.currentTimeMillis();if(b<=(g-this.m_frameCoheranceTimer)){this.m_frameCoheranceTimer=g;this.Game_Loop()}}catch(A){l=-1;this.UnInit();if(!GLLibConfig.disableNotifyDestroyed){k.notifyDestroyed()}this.catchThrowError=A}};q.prototype.paint=function(g){this.Game_Paint(g)};q.prototype.Game_Paint=function(A){if(s_game_isPaused||e){return}e=true;this.UpdateKeypad();i=System.currentTimeMillis();s_game_frameDT=(i-a);if(s_game_frameDT<0){s_game_frameDT=0}if(s_game_frameDT>1000){s_game_frameDT=1000}a=i;s_game_totalExecutionTime+=s_game_frameDT;s++;try{o=s_lastPaintGraphics=A;this.Game_update()}catch(g){l=-1;throw g}finally{e=false}};var f=null;var u=(3988292384).castToInt();function r(){f=[];for(var A=0;A<256;A++){var B=A;for(var g=8;g>0;g--){if((B&1)==1){B=(B>>>1)^u}else{B=(B>>>1)}}f[A]=B}}var n=0;function x(g){n=g}function c(E,A,F,B,D){var C=E.getColor();E.setARGBColor(n);E.fillRect(A,F,B,D);E.setColor(C)}function p(){if(arguments){switch(arguments.length){case 7:return v.apply(this,arguments);case 8:return t.apply(this,arguments)}}throw new Error("InvalidArguments")}function v(g,F,A,D,C,B,E){p(o,g,F,A,D,C,B,E)}function t(Q,F,E,G,P,J,I,S){if(true){Q.drawGradientRect(F,E,G,P,J,I,S)}else{var M=(J>>16)&255;var A=(J>>8)&255;var D=(J>>0)&255;var K=(I>>16)&255;var U=(I>>8)&255;var C=(I>>0)&255;var H=K-M;var R=U-A;var T=C-D;var O=F+G-1;var B=E+P-1;var N;M<<=16;A<<=16;D<<=16;if(S==LEFT){N=O-F;H=LowAPI.Float2Int((H<<16)/N);R=LowAPI.Float2Int((R<<16)/N);T=LowAPI.Float2Int((T<<16)/N);for(var L=O;L>=F;L--){SetColor(Q,(M>>16),(A>>16),(D>>16));DrawLine(Q,L,E,L,B);M+=H;A+=R;D+=T}}else{if(S==RIGHT){N=O-F;H=LowAPI.Float2Int((H<<16)/N);R=LowAPI.Float2Int((R<<16)/N);T=LowAPI.Float2Int((T<<16)/N);for(var L=F;L<=O;L++){SetColor(Q,(M>>16),(A>>16),(D>>16));DrawLine(Q,L,E,L,B);M+=H;A+=R;D+=T}}else{if(S==TOP){N=B-E;H=LowAPI.Float2Int((H<<16)/N);R=LowAPI.Float2Int((R<<16)/N);T=LowAPI.Float2Int((T<<16)/N);for(var L=B;L>=E;L--){SetColor(Q,(M>>16),(A>>16),(D>>16));DrawLine(Q,F,L,O,L);M+=H;A+=R;D+=T}}else{if(S==BOTTOM){N=B-E;H=LowAPI.Float2Int((H<<16)/N);R=LowAPI.Float2Int((R<<16)/N);T=LowAPI.Float2Int((T<<16)/N);for(var L=E;L<=B;L++){SetColor(Q,(M>>16),(A>>16),(D>>16));DrawLine(Q,F,L,O,L);M+=H;A+=R;D+=T}}}}}}}(function m(){Object.defineProperty(y,"g",{get:function(){return o},set:function(g){throw new Error("Not allow!")}});Object.defineProperty(y,"s_screenWidth",{get:function(){return z},set:function(g){throw new Error("Not allow!")}});Object.defineProperty(y,"s_screenHeight",{get:function(){return h},set:function(g){throw new Error("Not allow!")}});Object.defineProperty(y,"s_game_timeWhenFrameStart",{get:function(){return i},set:function(g){throw new Error("Not allow!")}});Object.defineProperty(y,"s_game_currentFrameNB",{get:function(){return s},set:function(g){throw new Error("Not allow!")}});Object.defineProperty(y,"s_gllib_instance",{get:function(){return j},set:function(g){throw new Error("Not allow!")}})})();LowAPI.extendObject(y,{GLLib:q,AlphaRect_SetColor:x,AlphaRect_Draw:c,DrawGradientRect:p,},true)})(window);