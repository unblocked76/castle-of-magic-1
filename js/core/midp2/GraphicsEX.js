(function(b,f){if(gllib_runtime.m_config["GraphicsRender"]=="webgl"){Graphics.is3D=true}else{if(gllib_runtime.m_config["GraphicsRender"]=="2d"){Graphics.is3D=false}else{if(((Device.IsAsus_AndroidBrowser&&(Device.IsAsus_Zen5||Device.IsAsus_Zen6))||Device.isWindowsPhone)&&!Device.IsAsus_Zen4){Graphics.is3D=false}else{Graphics.is3D=Device.webgl}}}if(!Graphics.is3D){b.GraphicsEX=Graphics;return}function a(g){this.m_HTMLCanvasElement=g;WebGL2D.enable(this.m_HTMLCanvasElement);this.m_CanvasRenderingContext2D=this.m_HTMLCanvasElement.getContext("webgl-2d");this.setDefault();this.m_PerspectiveShaderProgram=(function(l){var m={};var i=["attribute vec2 aVertCoord;","uniform mat4 uTransformMatrix;","varying vec2 vTextureCoord;","void main(void) {","    vTextureCoord = aVertCoord;","    gl_Position = uTransformMatrix * vec4(aVertCoord, 0.0, 1.0);","}"].join("\n");var k=l.createShader(l.VERTEX_SHADER);l.shaderSource(k,i);l.compileShader(k);if(!l.getShaderParameter(k,l.COMPILE_STATUS)){addError("Failed to compile vertex shader:"+l.getShaderInfoLog(k))}var j=["precision mediump float;","varying vec2 vTextureCoord;","uniform sampler2D uSampler;","void main(void)  {","    gl_FragColor = texture2D(uSampler, vTextureCoord);","}"].join("\n");var h=l.createShader(l.FRAGMENT_SHADER);l.shaderSource(h,j);l.compileShader(h);if(!l.getShaderParameter(h,l.COMPILE_STATUS)){addError("Failed to compile fragment shader:"+l.getShaderInfoLog(h))}m.shaderProgram=l.createProgram();l.attachShader(m.shaderProgram,k);l.attachShader(m.shaderProgram,h);l.linkProgram(m.shaderProgram);if(!l.getProgramParameter(m.shaderProgram,l.LINK_STATUS)){addError("Shader linking failed.")}m.vertexBuffer=l.createBuffer();l.useProgram(m.shaderProgram);m.vertAttrib=l.getAttribLocation(m.shaderProgram,"aVertCoord");m.transMatUniform=l.getUniformLocation(m.shaderProgram,"uTransformMatrix");m.samplerUniform=l.getUniformLocation(m.shaderProgram,"uSampler");return m})(this.m_CanvasRenderingContext2D)}LowAPI.extendClass(a,Graphics);b.GraphicsEX=a;var c=a;var e=a.prototype;function d(k,l){var h=numeric.transpose([[l[0].x,l[0].y,l[1].x,l[1].y,l[2].x,l[2].y,l[3].x,l[3].y]]);var g=[];for(var j=0;j<k.length;j++){g.push([k[j].x,0,-l[j].x*k[j].x,k[j].y,0,-l[j].x*k[j].y,1,0]);g.push([0,k[j].x,-l[j].y*k[j].x,0,k[j].y,-l[j].y*k[j].y,0,1])}return numeric.transpose(numeric.dot(numeric.inv(g),h))[0]}e.glDrawImagePerspective=function(g,r,q,A,z,G,D,k,j,y,x,C,B,H,E,m,l){var w=this._getContext2d();var I=this.m_PerspectiveShaderProgram;if(typeof l=="undefined"){y=0;x=0;C=g.width;B=0;H=0;E=g.height;m=g.width;l=g.height}w.useProgram(I.shaderProgram);var h=[{x:y/g.width,y:x/g.height},{x:C/g.width,y:B/g.height},{x:H/g.width,y:E/g.height},{x:m/g.width,y:l/g.height}];w.bindBuffer(w.ARRAY_BUFFER,I.vertexBuffer);var p=[];for(var u=0;u<h.length;u++){p.push(h[u].x);p.push(h[u].y)}var o=typeof I.vertices=="undefined";if(!o){for(var u=0;u<p.length;u++){if(p[u]!=I.vertices[u]){o=true;break}}}if(o){I.vertices=p;w.bufferData(w.ARRAY_BUFFER,new Float32Array(p),w.STATIC_DRAW)}var s=w.canvas.width;var F=w.canvas.height;var t=[{x:(2*r/s)-1,y:-(2*q/F)+1},{x:(2*A/s)-1,y:-(2*z/F)+1},{x:(2*G/s)-1,y:-(2*D/F)+1},{x:(2*k/s)-1,y:-(2*j/F)+1}];var n=d(h,t);w.enableVertexAttribArray(I.vertAttrib);w.vertexAttribPointer(I.vertAttrib,2,w.FLOAT,false,0,0);w.uniformMatrix4fv(I.transMatUniform,false,[n[0],n[1],0,n[2],n[3],n[4],0,n[5],0,0,0,0,n[6],n[7],0,1]);w.activeTexture(w.TEXTURE0);w.bindTexture(w.TEXTURE_2D,g.obj);w.uniform1i(I.samplerUniform,0);w.drawArrays(w.TRIANGLE_STRIP,0,4)};b.GraphicsEX=a}(window));